#!/usr/bin/env python3
"""
Generate 8 topic-based vocabulary wordbook JS files.

Topics: tech, social_media, gaming, finance, marketing, film, medical, science

Architecture (same as generate_scene_wordbooks.py):
1. Read oxford_5000_cleaned.csv to reuse translations
2. Check if audio file exists in tts_delivery/audio/{word}.wav
3. Use hardcoded TOPIC_CATEGORIES word lists
4. For words in Oxford CSV -> reuse translation; otherwise -> use EXTRA_TRANSLATIONS
5. Output: wordbooks/topic_{name}.js with registerWordbook() call
"""

import csv
import os
import sys

# Fix Windows console encoding
if sys.stdout.encoding != 'utf-8':
    sys.stdout.reconfigure(encoding='utf-8', errors='replace')

# === Paths ===
SCRIPT_DIR = os.path.dirname(os.path.abspath(__file__))
PROJECT_DIR = os.path.dirname(SCRIPT_DIR)
OXFORD_CSV = os.path.join(SCRIPT_DIR, 'oxford_5000_cleaned.csv')
AUDIO_DIR = os.path.join(SCRIPT_DIR, 'tts_delivery', 'audio')
OUTPUT_DIR = os.path.join(PROJECT_DIR, 'wordbooks')

# =============================================================
# Topic Categories - word lists
# =============================================================
TOPIC_CATEGORIES = {
    'tech': {
        'name': '\u79d1\u6280\u4e92\u8054\u7f51',
        'emoji': '\U0001f4bb',
        'description': '\u8ba1\u7b97\u673a\u3001\u4e92\u8054\u7f51\u3001\u4eba\u5de5\u667a\u80fd\u76f8\u5173\u8bcd\u6c47',
        'words': [
            'algorithm', 'application', 'artificial', 'automate', 'bandwidth',
            'battery', 'binary', 'bluetooth', 'broadcast', 'browser',
            'bug', 'cable', 'calculate', 'capacity', 'cellular',
            'chip', 'circuit', 'click', 'cloud', 'code',
            'compatible', 'component', 'compute', 'connect', 'convert',
            'cookie', 'crash', 'cursor', 'cyber', 'data',
            'database', 'debug', 'decode', 'default', 'delete',
            'desktop', 'detect', 'device', 'digital', 'display',
            'domain', 'download', 'drone', 'email', 'embed',
            'encode', 'encrypt', 'engine', 'ethernet', 'export',
            'file', 'filter', 'firewall', 'firmware', 'format',
            'framework', 'function', 'generate', 'gigabyte', 'graphic',
            'hack', 'hardware', 'homepage', 'host', 'icon',
            'import', 'index', 'input', 'install', 'integrate',
            'intelligence', 'interface', 'internet', 'keyboard', 'laptop',
            'launch', 'link', 'load', 'login', 'malware',
            'memory', 'merge', 'microchip', 'mobile', 'modem',
            'module', 'monitor', 'mouse', 'navigate', 'network',
            'node', 'offline', 'online', 'operate', 'optimize',
            'output', 'password', 'patch', 'pixel', 'platform',
            'plugin', 'port', 'portal', 'privacy', 'process',
            'processor', 'program', 'protocol', 'proxy', 'query',
            'reboot', 'render', 'robot', 'router', 'scan',
            'screen', 'script', 'scroll', 'search', 'secure',
            'sensor', 'server', 'signal', 'simulate', 'smartphone',
            'software', 'spam', 'storage', 'stream', 'surf',
            'sync', 'system', 'tablet', 'tech', 'template',
            'terminal', 'token', 'toolbar', 'trace', 'traffic',
            'transmit', 'update', 'upgrade', 'upload', 'username',
            'verify', 'version', 'virtual', 'virus', 'web',
            'widget', 'wifi', 'wireless', 'zip',
        ],
    },
    'social_media': {
        'name': '\u793e\u4ea4\u5a92\u4f53',
        'emoji': '\U0001f4f1',
        'description': '\u793e\u4ea4\u7f51\u7edc\u3001\u5185\u5bb9\u521b\u4f5c\u3001\u7f51\u7edc\u4ea4\u6d41\u76f8\u5173\u8bcd\u6c47',
        'words': [
            'account', 'algorithm', 'anonymous', 'audience', 'authentic',
            'avatar', 'ban', 'bias', 'block', 'blog',
            'bookmark', 'bot', 'caption', 'celebrity', 'censor',
            'channel', 'chat', 'click', 'collaborate', 'comment',
            'community', 'connect', 'content', 'conversation', 'create',
            'creator', 'crowd', 'curate', 'dashboard', 'debate',
            'delete', 'digital', 'discover', 'dislike', 'donate',
            'edit', 'emoji', 'engage', 'explore', 'expose',
            'fake', 'fan', 'feed', 'filter', 'follow',
            'follower', 'forum', 'friend', 'generate', 'group',
            'handle', 'hashtag', 'highlight', 'identity', 'image',
            'impact', 'inbox', 'influence', 'influencer', 'interact',
            'invite', 'like', 'link', 'live', 'login',
            'mention', 'message', 'meme', 'moderate', 'network',
            'news', 'notify', 'offline', 'online', 'opinion',
            'outreach', 'pin', 'platform', 'podcast', 'poll',
            'popular', 'post', 'privacy', 'profile', 'promote',
            'public', 'publish', 'react', 'reach', 'recommend',
            'reply', 'report', 'repost', 'review', 'scroll',
            'search', 'share', 'status', 'story', 'stream',
            'subscribe', 'tag', 'thread', 'timeline', 'troll',
            'trend', 'trending', 'unfollow', 'update', 'upload',
            'user', 'verify', 'video', 'view', 'viral',
            'voice', 'vlog',
        ],
    },
    'gaming': {
        'name': '\u6e38\u620f\u7535\u7ade',
        'emoji': '\U0001f3ae',
        'description': '\u7535\u5b50\u6e38\u620f\u3001\u7535\u7ade\u3001\u6e38\u620f\u673a\u5236\u76f8\u5173\u8bcd\u6c47',
        'words': [
            'achievement', 'action', 'adventure', 'aim', 'alliance',
            'animation', 'arcade', 'arena', 'armour', 'assist',
            'attack', 'avatar', 'badge', 'balance', 'ban',
            'battle', 'beta', 'bonus', 'boss', 'bot',
            'buff', 'build', 'campaign', 'capture', 'casual',
            'champion', 'character', 'cheat', 'checkpoint', 'clan',
            'clash', 'class', 'classic', 'combat', 'combo',
            'command', 'competitive', 'console', 'controller', 'craft',
            'crash', 'create', 'crew', 'critical', 'custom',
            'damage', 'debug', 'deck', 'defend', 'demo',
            'deploy', 'dodge', 'download', 'dragon', 'dungeon',
            'elite', 'emote', 'enemy', 'engine', 'epic',
            'equip', 'escape', 'event', 'execute', 'expand',
            'experience', 'exploit', 'explore', 'fantasy', 'fight',
            'final', 'fire', 'forge', 'frame', 'fury',
            'gear', 'glitch', 'grind', 'guild', 'health',
            'hero', 'hunt', 'inventory', 'item', 'jump',
            'kill', 'kingdom', 'launch', 'league', 'legend',
            'level', 'lobby', 'loot', 'magic', 'map',
            'master', 'match', 'mission', 'mode', 'monster',
            'mount', 'multiplayer', 'nerf', 'objective', 'online',
            'opponent', 'patch', 'penalty', 'platform', 'play',
            'player', 'point', 'portal', 'power', 'quest',
            'rage', 'raid', 'rank', 'realm', 'release',
            'replay', 'respawn', 'reward', 'rival', 'role',
            'round', 'rush', 'score', 'server', 'shield',
            'shoot', 'siege', 'skill', 'snipe', 'solo',
            'spawn', 'speed', 'spell', 'sprint', 'stage',
            'stamina', 'strategy', 'stream', 'strike', 'summon',
            'survival', 'sword', 'talent', 'target', 'team',
            'token', 'tower', 'trade', 'trap', 'treasure',
            'trigger', 'trophy', 'tutorial', 'ultimate', 'unlock',
            'update', 'upgrade', 'versus', 'victory', 'virtual',
            'warrior', 'weapon', 'wizard', 'zone',
        ],
    },
    'finance': {
        'name': '\u5546\u52a1\u91d1\u878d',
        'emoji': '\U0001f4b0',
        'description': '\u91d1\u878d\u3001\u94f6\u884c\u3001\u6295\u8d44\u3001\u5546\u52a1\u76f8\u5173\u8bcd\u6c47',
        'words': [
            'account', 'accountant', 'acquire', 'annual', 'asset',
            'audit', 'balance', 'bankrupt', 'bargain', 'bear',
            'benefit', 'bid', 'bill', 'bond', 'bonus',
            'borrow', 'broker', 'budget', 'bull', 'capital',
            'cash', 'charge', 'check', 'claim', 'client',
            'coin', 'collapse', 'commerce', 'commission', 'commodity',
            'compensate', 'compete', 'compound', 'contract', 'corporate',
            'cost', 'coupon', 'crash', 'credit', 'currency',
            'custom', 'customer', 'deal', 'debt', 'decline',
            'default', 'deficit', 'demand', 'deposit', 'depreciate',
            'discount', 'dividend', 'earnings', 'economy', 'enterprise',
            'equity', 'estimate', 'exchange', 'expense', 'export',
            'fee', 'finance', 'fiscal', 'forecast', 'fortune',
            'franchise', 'fraud', 'fund', 'gain', 'goods',
            'gross', 'growth', 'guarantee', 'hedge', 'import',
            'income', 'index', 'inflation', 'insure', 'interest',
            'invest', 'investor', 'invoice', 'lease', 'lend',
            'leverage', 'liability', 'liquid', 'loan', 'loss',
            'margin', 'market', 'merge', 'monopoly', 'mortgage',
            'mutual', 'negotiate', 'net', 'offset', 'overhead',
            'partner', 'patent', 'penalty', 'pension', 'portfolio',
            'premium', 'price', 'principal', 'profit', 'property',
            'purchase', 'quarter', 'quota', 'rate', 'receipt',
            'recession', 'refund', 'regulate', 'rent', 'retail',
            'retire', 'return', 'revenue', 'risk', 'salary',
            'security', 'share', 'shortage', 'speculate', 'stake',
            'stock', 'subsidy', 'surplus', 'tariff', 'tax',
            'tender', 'trade', 'transaction', 'treasury', 'turnover',
            'utility', 'value', 'venture', 'wage', 'wealth',
            'wholesale', 'withdraw', 'yield',
        ],
    },
    'marketing': {
        'name': '\u8425\u9500\u5e7f\u544a',
        'emoji': '\U0001f4ca',
        'description': '\u5e02\u573a\u8425\u9500\u3001\u5e7f\u544a\u3001\u54c1\u724c\u63a8\u5e7f\u76f8\u5173\u8bcd\u6c47',
        'words': [
            'advertise', 'advertisement', 'affiliate', 'agency', 'analyse',
            'appeal', 'audience', 'awareness', 'benchmark', 'billboard',
            'boost', 'brand', 'broadcast', 'brochure', 'budget',
            'bundle', 'buyer', 'campaign', 'catalogue', 'channel',
            'client', 'collaborate', 'commercial', 'commission', 'communicate',
            'compete', 'consumer', 'content', 'conversion', 'convince',
            'coupon', 'create', 'creative', 'customer', 'data',
            'deadline', 'deal', 'deliver', 'demand', 'demographic',
            'design', 'digital', 'direct', 'discount', 'display',
            'distribute', 'domain', 'email', 'endorse', 'engage',
            'estimate', 'event', 'execute', 'expand', 'exposure',
            'feature', 'feedback', 'filter', 'focus', 'forecast',
            'franchise', 'frequency', 'fund', 'generate', 'graphic',
            'growth', 'guarantee', 'headline', 'highlight', 'identity',
            'image', 'impact', 'impression', 'incentive', 'influence',
            'innovation', 'insight', 'interview', 'invest', 'launch',
            'layout', 'lead', 'logo', 'loyalty', 'margin',
            'market', 'media', 'merchandise', 'metric', 'motto',
            'negotiate', 'network', 'niche', 'objective', 'offer',
            'optimize', 'organic', 'outreach', 'partner', 'perception',
            'persuade', 'pitch', 'platform', 'poll', 'position',
            'premium', 'press', 'price', 'print', 'product',
            'profile', 'profit', 'promote', 'promotion', 'prospect',
            'public', 'publish', 'purchase', 'rate', 'reach',
            'recommend', 'referral', 'reputation', 'retail', 'return',
            'revenue', 'review', 'sample', 'segment', 'slogan',
            'sponsor', 'strategy', 'subscribe', 'survey', 'tag',
            'target', 'testimonial', 'track', 'trade', 'traffic',
            'trend', 'value', 'viral', 'visual', 'wholesale',
        ],
    },
    'film': {
        'name': '\u7535\u5f71\u5f71\u89c6',
        'emoji': '\U0001f3ac',
        'description': '\u7535\u5f71\u3001\u7535\u89c6\u3001\u8868\u6f14\u3001\u62cd\u6444\u76f8\u5173\u8bcd\u6c47',
        'words': [
            'act', 'action', 'actor', 'actress', 'adapt',
            'adventure', 'alien', 'angle', 'animate', 'animation',
            'applause', 'audience', 'audition', 'award', 'background',
            'blockbuster', 'broadcast', 'camera', 'caption', 'cast',
            'celebrity', 'chapter', 'character', 'cinema', 'classic',
            'clip', 'comedy', 'commercial', 'compose', 'conclude',
            'conflict', 'contrast', 'costume', 'create', 'creative',
            'credit', 'crew', 'critic', 'cut', 'dark',
            'dialogue', 'digital', 'direct', 'director', 'display',
            'documentary', 'draft', 'drama', 'dramatic', 'dub',
            'edit', 'edition', 'editor', 'effect', 'emotion',
            'ending', 'entertain', 'entertainment', 'epic', 'episode',
            'event', 'exhibit', 'express', 'extra', 'fade',
            'fan', 'fantasy', 'feature', 'fiction', 'film',
            'filter', 'final', 'flash', 'focus', 'footage',
            'format', 'frame', 'genre', 'hero', 'horror',
            'image', 'imagine', 'independent', 'inspire', 'install',
            'interpret', 'interview', 'joke', 'jump', 'launch',
            'legend', 'lens', 'light', 'location', 'makeup',
            'master', 'media', 'motion', 'musical', 'mystery',
            'narrative', 'nominate', 'novel', 'original', 'Oscar',
            'perform', 'performance', 'performer', 'photograph', 'pilot',
            'plot', 'point', 'premiere', 'present', 'preview',
            'produce', 'producer', 'production', 'project', 'promote',
            'publish', 'rate', 'reality', 'record', 'release',
            'remake', 'render', 'replay', 'represent', 'review',
            'role', 'romance', 'scene', 'score', 'screen',
            'screenplay', 'script', 'sequel', 'series', 'set',
            'shoot', 'shot', 'silent', 'sound', 'soundtrack',
            'special', 'sponsor', 'stage', 'star', 'story',
            'stream', 'studio', 'style', 'subtitle', 'talent',
            'theme', 'thriller', 'ticket', 'title', 'tone',
            'track', 'trailer', 'twist', 'version', 'video',
            'view', 'villain', 'visual', 'voice', 'volume',
        ],
    },
    'medical': {
        'name': '\u533b\u5b66\u7528\u8bed',
        'emoji': '\U0001f3e5',
        'description': '\u533b\u7597\u3001\u75be\u75c5\u3001\u836f\u7269\u3001\u4eba\u4f53\u76f8\u5173\u8bcd\u6c47',
        'words': [
            'ache', 'acute', 'addict', 'adverse', 'aging',
            'aid', 'allergy', 'ambulance', 'anatomy', 'antibiotic',
            'anxiety', 'artery', 'bacteria', 'bandage', 'bleed',
            'blind', 'blood', 'bone', 'brain', 'breath',
            'bruise', 'burn', 'calcium', 'cancer', 'capsule',
            'cardiac', 'cell', 'checkup', 'chest', 'chronic',
            'clinic', 'clinical', 'collapse', 'coma', 'condition',
            'conscious', 'consult', 'contagious', 'cure', 'deaf',
            'deficiency', 'depress', 'diagnose', 'diagnosis', 'diet',
            'disability', 'discharge', 'disease', 'disorder', 'dizzy',
            'doctor', 'dose', 'drug', 'emergency', 'emotion',
            'epidemic', 'examine', 'exercise', 'exhaust', 'fatal',
            'fatigue', 'fever', 'flu', 'fracture', 'gene',
            'genetic', 'germ', 'heal', 'health', 'heart',
            'hormone', 'hospital', 'hygiene', 'ill', 'immune',
            'implant', 'infant', 'infect', 'infection', 'inflammation',
            'inject', 'injection', 'injure', 'injury', 'intensive',
            'internal', 'kidney', 'laboratory', 'limb', 'liver',
            'lung', 'medicine', 'mental', 'metabolism', 'microscope',
            'muscle', 'nerve', 'nurse', 'nutrition', 'obesity',
            'operate', 'operation', 'organ', 'oxygen', 'pain',
            'paralyse', 'patient', 'pharmacy', 'physical', 'physician',
            'pill', 'poison', 'pregnant', 'prescribe', 'prescription',
            'pressure', 'prevent', 'procedure', 'protein', 'psychiatry',
            'pulse', 'recover', 'recovery', 'remedy', 'resist',
            'scan', 'skin', 'specialist', 'spine', 'sterile',
            'stomach', 'stress', 'stroke', 'surgery', 'surgeon',
            'survive', 'swallow', 'symptom', 'syndrome', 'therapy',
            'tissue', 'toxic', 'transplant', 'treat', 'treatment',
            'tumour', 'vaccine', 'vein', 'virus', 'vitamin',
            'ward', 'wound', 'x-ray',
        ],
    },
    'science': {
        'name': '\u79d1\u5b66\u5b9e\u9a8c',
        'emoji': '\U0001f52c',
        'description': '\u79d1\u5b66\u7814\u7a76\u3001\u5b9e\u9a8c\u3001\u7269\u7406\u5316\u5b66\u751f\u7269\u76f8\u5173\u8bcd\u6c47',
        'words': [
            'absorb', 'abstract', 'accelerate', 'acid', 'analyse',
            'analysis', 'apparatus', 'apply', 'approximate', 'atom',
            'bacteria', 'beam', 'biology', 'bond', 'breed',
            'carbon', 'catalyst', 'cell', 'chain', 'chamber',
            'chemical', 'chemistry', 'circuit', 'classify', 'climate',
            'clone', 'coal', 'compound', 'compute', 'concentrate',
            'concept', 'conclusion', 'conduct', 'confirm', 'conserve',
            'constant', 'construct', 'consume', 'contaminate', 'control',
            'convert', 'core', 'correlate', 'crystal', 'current',
            'curve', 'cycle', 'data', 'decay', 'demonstrate',
            'density', 'derive', 'detect', 'device', 'diagram',
            'dimension', 'discover', 'discovery', 'dissolve', 'distinct',
            'DNA', 'document', 'element', 'emit', 'empirical',
            'energy', 'engineer', 'environment', 'enzyme', 'equation',
            'equilibrium', 'evaluate', 'evidence', 'evolve', 'examine',
            'experiment', 'exploit', 'explode', 'expose', 'extract',
            'factor', 'filter', 'finding', 'fluid', 'force',
            'formula', 'fossil', 'fraction', 'frequency', 'friction',
            'fuel', 'function', 'fundamental', 'fusion', 'gas',
            'gene', 'generate', 'genetic', 'geology', 'gravity',
            'habitat', 'heat', 'humidity', 'hydrogen', 'hypothesis',
            'illustrate', 'immune', 'impact', 'infer', 'infrared',
            'ingredient', 'inspect', 'instrument', 'insulate', 'interact',
            'interval', 'investigate', 'isolate', 'journal', 'laboratory',
            'laser', 'layer', 'lens', 'liquid', 'magnet',
            'magnitude', 'mass', 'material', 'matter', 'measure',
            'mechanism', 'method', 'microscope', 'mineral', 'mixture',
            'model', 'molecule', 'momentum', 'monitor', 'motion',
            'neutral', 'neutron', 'nitrogen', 'nuclear', 'nucleus',
            'observe', 'orbit', 'organic', 'organism', 'origin',
            'output', 'oxide', 'oxygen', 'particle', 'patent',
            'phase', 'phenomenon', 'physics', 'plasma', 'polar',
            'predict', 'pressure', 'principle', 'probe', 'procedure',
            'process', 'property', 'proportion', 'protein', 'proton',
            'publish', 'quantum', 'radiation', 'reaction', 'reagent',
            'research', 'resist', 'result', 'reveal', 'sample',
            'satellite', 'scale', 'scan', 'sequence', 'simulate',
            'solar', 'solution', 'solve', 'species', 'specimen',
            'spectrum', 'stable', 'static', 'stem', 'structure',
            'substance', 'survey', 'sustain', 'synthesis', 'temperature',
            'theorem', 'theory', 'thermal', 'tissue', 'toxic',
            'transform', 'trial', 'universe', 'vacuum', 'valid',
            'variable', 'velocity', 'verify', 'volume', 'wave',
            'wavelength',
        ],
    },
}

# =============================================================
# Extra translations for words NOT in Oxford 5000
# =============================================================
EXTRA_TRANSLATIONS = {
    # Tech
    'algorithm': '\u7b97\u6cd5',
    'automate': '\u81ea\u52a8\u5316',
    'bandwidth': '\u5e26\u5bbd',
    'binary': '\u4e8c\u8fdb\u5236',
    'bluetooth': '\u84dd\u7259',
    'browser': '\u6d4f\u89c8\u5668',
    'bug': '\u6f0f\u6d1e',
    'cellular': '\u8702\u7a9d\u7f51\u7edc',
    'circuit': '\u7535\u8def',
    'click': '\u70b9\u51fb',
    'cloud': '\u4e91',
    'code': '\u4ee3\u7801',
    'compatible': '\u517c\u5bb9\u7684',
    'cookie': '\u5c0f\u578b\u6587\u672c\u6587\u4ef6',
    'cursor': '\u5149\u6807',
    'cyber': '\u7f51\u7edc\u7684',
    'database': '\u6570\u636e\u5e93',
    'debug': '\u8c03\u8bd5',
    'decode': '\u89e3\u7801',
    'desktop': '\u684c\u9762',
    'download': '\u4e0b\u8f7d',
    'drone': '\u65e0\u4eba\u673a',
    'email': '\u7535\u5b50\u90ae\u4ef6',
    'embed': '\u5d4c\u5165',
    'encode': '\u7f16\u7801',
    'encrypt': '\u52a0\u5bc6',
    'ethernet': '\u4ee5\u592a\u7f51',
    'file': '\u6587\u4ef6',
    'firewall': '\u9632\u706b\u5899',
    'firmware': '\u56fa\u4ef6',
    'framework': '\u6846\u67b6',
    'gigabyte': '\u5409\u5b57\u8282',
    'hack': '\u9ed1\u5ba2\u653b\u51fb',
    'hardware': '\u786c\u4ef6',
    'homepage': '\u4e3b\u9875',
    'icon': '\u56fe\u6807',
    'keyboard': '\u952e\u76d8',
    'laptop': '\u7b14\u8bb0\u672c\u7535\u8111',
    'login': '\u767b\u5f55',
    'malware': '\u6076\u610f\u8f6f\u4ef6',
    'microchip': '\u5fae\u82af\u7247',
    'modem': '\u8c03\u5236\u89e3\u8c03\u5668',
    'mouse': '\u9f20\u6807',
    'network': '\u7f51\u7edc',
    'node': '\u8282\u70b9',
    'offline': '\u79bb\u7ebf',
    'online': '\u5728\u7ebf',
    'optimize': '\u4f18\u5316',
    'password': '\u5bc6\u7801',
    'patch': '\u8865\u4e01',
    'pixel': '\u50cf\u7d20',
    'plugin': '\u63d2\u4ef6',
    'portal': '\u95e8\u6237\u7f51\u7ad9',
    'processor': '\u5904\u7406\u5668',
    'protocol': '\u534f\u8bae',
    'proxy': '\u4ee3\u7406',
    'query': '\u67e5\u8be2',
    'reboot': '\u91cd\u542f',
    'render': '\u6e32\u67d3',
    'router': '\u8def\u7531\u5668',
    'scan': '\u626b\u63cf',
    'screen': '\u5c4f\u5e55',
    'script': '\u811a\u672c',
    'scroll': '\u6eda\u52a8',
    'sensor': '\u4f20\u611f\u5668',
    'server': '\u670d\u52a1\u5668',
    'simulate': '\u6a21\u62df',
    'smartphone': '\u667a\u80fd\u624b\u673a',
    'software': '\u8f6f\u4ef6',
    'spam': '\u5783\u573e\u90ae\u4ef6',
    'stream': '\u6d41\u5a92\u4f53',
    'surf': '\u4e0a\u7f51\u6d4f\u89c8',
    'sync': '\u540c\u6b65',
    'tablet': '\u5e73\u677f\u7535\u8111',
    'tech': '\u79d1\u6280',
    'template': '\u6a21\u677f',
    'terminal': '\u7ec8\u7aef',
    'token': '\u4ee4\u724c',
    'toolbar': '\u5de5\u5177\u680f',
    'trace': '\u8ffd\u8e2a',
    'upload': '\u4e0a\u4f20',
    'username': '\u7528\u6237\u540d',
    'virtual': '\u865a\u62df\u7684',
    'virus': '\u75c5\u6bd2',
    'web': '\u7f51\u9875',
    'widget': '\u5c0f\u7ec4\u4ef6',
    'wifi': '\u65e0\u7ebf\u7f51\u7edc',
    'wireless': '\u65e0\u7ebf\u7684',
    'zip': '\u538b\u7f29',

    # Social Media
    'avatar': '\u5934\u50cf',
    'blog': '\u535a\u5ba2',
    'bookmark': '\u4e66\u7b7e',
    'bot': '\u673a\u5668\u4eba',
    'caption': '\u5b57\u5e55',
    'censor': '\u5ba1\u67e5',
    'chat': '\u804a\u5929',
    'creator': '\u521b\u4f5c\u8005',
    'curate': '\u7b56\u5c55',
    'dashboard': '\u4eea\u8868\u76d8',
    'dislike': '\u4e0d\u559c\u6b22',
    'emoji': '\u8868\u60c5\u7b26\u53f7',
    'feed': '\u4fe1\u606f\u6d41',
    'follower': '\u7c89\u4e1d',
    'forum': '\u8bba\u575b',
    'handle': '\u7528\u6237\u540d',
    'hashtag': '\u8bdd\u9898\u6807\u7b7e',
    'inbox': '\u6536\u4ef6\u7bb1',
    'influencer': '\u7f51\u7ea2',
    'meme': '\u7f51\u7edc\u6d41\u884c\u56fe',
    'moderate': '\u5ba1\u6838',
    'notify': '\u901a\u77e5',
    'outreach': '\u5916\u5c55',
    'pin': '\u7f6e\u9876',
    'podcast': '\u64ad\u5ba2',
    'poll': '\u6295\u7968',
    'post': '\u53d1\u5e03',
    'profile': '\u4e2a\u4eba\u8d44\u6599',
    'react': '\u56de\u5e94',
    'repost': '\u8f6c\u53d1',
    'share': '\u5206\u4eab',
    'status': '\u52a8\u6001',
    'subscribe': '\u8ba2\u9605',
    'tag': '\u6807\u7b7e',
    'thread': '\u8bdd\u9898\u4e32',
    'timeline': '\u65f6\u95f4\u7ebf',
    'troll': '\u7f51\u7edc\u5587\u53ed',
    'trending': '\u70ed\u95e8\u7684',
    'unfollow': '\u53d6\u6d88\u5173\u6ce8',
    'user': '\u7528\u6237',
    'viral': '\u75c5\u6bd2\u5f0f\u4f20\u64ad\u7684',
    'vlog': '\u89c6\u9891\u535a\u5ba2',

    # Gaming
    'arcade': '\u8857\u673a',
    'arena': '\u7ade\u6280\u573a',
    'armour': '\u76d4\u7532',
    'badge': '\u5fbd\u7ae0',
    'boss': 'Boss\u602a',
    'buff': '\u589e\u76ca',
    'checkpoint': '\u5b58\u6863\u70b9',
    'clan': '\u6218\u961f',
    'clash': '\u51b2\u7a81',
    'combo': '\u8fde\u62db',
    'competitive': '\u7ade\u6280\u7684',
    'console': '\u6e38\u620f\u673a',
    'controller': '\u624b\u67c4',
    'craft': '\u5236\u4f5c',
    'deck': '\u724c\u7ec4',
    'demo': '\u8bd5\u73a9\u7248',
    'deploy': '\u90e8\u7f72',
    'dodge': '\u95ea\u907f',
    'dungeon': '\u5730\u7262',
    'elite': '\u7cbe\u82f1',
    'emote': '\u8868\u60c5\u52a8\u4f5c',
    'equip': '\u88c5\u5907',
    'forge': '\u953b\u9020',
    'frame': '\u5e27',
    'fury': '\u72c2\u6012',
    'gear': '\u88c5\u5907',
    'glitch': '\u6f0f\u6d1e',
    'grind': '\u5237\u7b49\u7ea7',
    'guild': '\u516c\u4f1a',
    'inventory': '\u80cc\u5305',
    'item': '\u7269\u54c1',
    'kingdom': '\u738b\u56fd',
    'league': '\u8054\u8d5b',
    'lobby': '\u5927\u5385',
    'loot': '\u6218\u5229\u54c1',
    'mount': '\u5750\u9a91',
    'multiplayer': '\u591a\u4eba\u6e38\u620f',
    'nerf': '\u524a\u5f31',
    'opponent': '\u5bf9\u624b',
    'quest': '\u4efb\u52a1',
    'rage': '\u72c2\u6012',
    'raid': '\u526f\u672c',
    'realm': '\u9886\u57df',
    'replay': '\u56de\u653e',
    'respawn': '\u590d\u6d3b',
    'rival': '\u5bf9\u624b',
    'siege': '\u56f4\u653b',
    'snipe': '\u72d9\u51fb',
    'solo': '\u5355\u4eba',
    'spawn': '\u751f\u6210',
    'spell': '\u6cd5\u672f',
    'sprint': '\u51b2\u523a',
    'stamina': '\u8010\u529b',
    'summon': '\u53ec\u5524',
    'sword': '\u5251',
    'tower': '\u5854',
    'trap': '\u9677\u9631',
    'treasure': '\u5b9d\u85cf',
    'tutorial': '\u65b0\u624b\u6559\u7a0b',
    'ultimate': '\u7ec8\u6781\u6280\u80fd',
    'unlock': '\u89e3\u9501',
    'upgrade': '\u5347\u7ea7',
    'versus': '\u5bf9\u6218',
    'warrior': '\u6218\u58eb',
    'wizard': '\u5deb\u5e08',
    'zone': '\u533a\u57df',

    # Finance
    'accountant': '\u4f1a\u8ba1',
    'audit': '\u5ba1\u8ba1',
    'bankrupt': '\u7834\u4ea7',
    'bargain': '\u4ea4\u6613',
    'bear': '\u718a\u5e02',
    'bid': '\u51fa\u4ef7',
    'bond': '\u503a\u5238',
    'broker': '\u7ecf\u7eaa\u4eba',
    'bull': '\u725b\u5e02',
    'capital': '\u8d44\u672c',
    'cash': '\u73b0\u91d1',
    'client': '\u5ba2\u6237',
    'coin': '\u786c\u5e01',
    'commerce': '\u5546\u4e1a',
    'commodity': '\u5546\u54c1',
    'corporate': '\u516c\u53f8\u7684',
    'coupon': '\u4f18\u60e0\u5238',
    'credit': '\u4fe1\u7528',
    'currency': '\u8d27\u5e01',
    'customer': '\u5ba2\u6237',
    'debt': '\u503a\u52a1',
    'deficit': '\u8d64\u5b57',
    'deposit': '\u5b58\u6b3e',
    'depreciate': '\u8d2c\u503c',
    'dividend': '\u80a1\u606f',
    'earnings': '\u6536\u5165',
    'enterprise': '\u4f01\u4e1a',
    'equity': '\u80a1\u6743',
    'fee': '\u8d39\u7528',
    'fiscal': '\u8d22\u653f\u7684',
    'forecast': '\u9884\u6d4b',
    'fortune': '\u8d22\u5bcc',
    'franchise': '\u7279\u8bb8\u7ecf\u8425',
    'fraud': '\u6b3a\u8bc8',
    'hedge': '\u5bf9\u51b2',
    'inflation': '\u901a\u8d27\u81a8\u80c0',
    'insure': '\u4fdd\u9669',
    'invoice': '\u53d1\u7968',
    'lease': '\u79df\u8d41',
    'lend': '\u501f\u51fa',
    'leverage': '\u6760\u6746',
    'liability': '\u8d1f\u503a',
    'liquid': '\u6d41\u52a8\u6027',
    'loan': '\u8d37\u6b3e',
    'margin': '\u5229\u6da6',
    'merge': '\u5408\u5e76',
    'monopoly': '\u5784\u65ad',
    'mortgage': '\u62b5\u62bc\u8d37\u6b3e',
    'mutual': '\u5171\u540c\u7684',
    'negotiate': '\u8c08\u5224',
    'offset': '\u62b5\u6d88',
    'overhead': '\u7ba1\u7406\u8d39\u7528',
    'patent': '\u4e13\u5229',
    'pension': '\u517b\u8001\u91d1',
    'portfolio': '\u6295\u8d44\u7ec4\u5408',
    'premium': '\u4fdd\u8d39',
    'principal': '\u672c\u91d1',
    'quota': '\u914d\u989d',
    'receipt': '\u6536\u636e',
    'recession': '\u8870\u9000',
    'refund': '\u9000\u6b3e',
    'regulate': '\u76d1\u7ba1',
    'retail': '\u96f6\u552e',
    'revenue': '\u6536\u5165',
    'salary': '\u85aa\u6c34',
    'share': '\u80a1\u4efd',
    'shortage': '\u77ed\u7f3a',
    'speculate': '\u6295\u673a',
    'stake': '\u80a1\u4efd',
    'stock': '\u80a1\u7968',
    'subsidy': '\u8865\u8d34',
    'surplus': '\u76c8\u4f59',
    'tariff': '\u5173\u7a0e',
    'tender': '\u62db\u6807',
    'transaction': '\u4ea4\u6613',
    'treasury': '\u8d22\u653f\u90e8',
    'turnover': '\u8425\u4e1a\u989d',
    'utility': '\u516c\u7528\u4e8b\u4e1a',
    'venture': '\u98ce\u9669\u6295\u8d44',
    'wage': '\u5de5\u8d44',
    'wealth': '\u8d22\u5bcc',
    'wholesale': '\u6279\u53d1',
    'withdraw': '\u53d6\u6b3e',
    'yield': '\u6536\u76ca',

    # Marketing
    'affiliate': '\u8054\u76df',
    'awareness': '\u77e5\u540d\u5ea6',
    'benchmark': '\u57fa\u51c6',
    'billboard': '\u5e7f\u544a\u724c',
    'boost': '\u63a8\u52a8',
    'brand': '\u54c1\u724c',
    'brochure': '\u624b\u518c',
    'bundle': '\u6346\u7ed1\u9500\u552e',
    'buyer': '\u4e70\u5bb6',
    'catalogue': '\u76ee\u5f55',
    'conversion': '\u8f6c\u5316',
    'deadline': '\u622a\u6b62\u65e5\u671f',
    'demographic': '\u4eba\u53e3\u7edf\u8ba1\u7684',
    'endorse': '\u4ee3\u8a00',
    'feedback': '\u53cd\u9988',
    'frequency': '\u9891\u7387',
    'headline': '\u6807\u9898',
    'incentive': '\u6fc0\u52b1',
    'innovation': '\u521b\u65b0',
    'insight': '\u6d1e\u5bdf',
    'layout': '\u5e03\u5c40',
    'lead': '\u6f5c\u5728\u5ba2\u6237',
    'logo': '\u6807\u5fd7',
    'loyalty': '\u5fe0\u8bda\u5ea6',
    'merchandise': '\u5546\u54c1',
    'metric': '\u6307\u6807',
    'motto': '\u5e7f\u544a\u8bed',
    'niche': '\u5c0f\u4f17\u5e02\u573a',
    'organic': '\u81ea\u7136\u589e\u957f\u7684',
    'perception': '\u611f\u77e5',
    'persuade': '\u8bf4\u670d',
    'pitch': '\u63a8\u9500',
    'prospect': '\u6f5c\u5728\u5ba2\u6237',
    'referral': '\u63a8\u8350',
    'reputation': '\u58f0\u8a89',
    'sample': '\u6837\u54c1',
    'segment': '\u7ec6\u5206\u5e02\u573a',
    'slogan': '\u6807\u8bed',
    'sponsor': '\u8d5e\u52a9\u5546',
    'survey': '\u8c03\u67e5',
    'target': '\u76ee\u6807\u5ba2\u6237',
    'testimonial': '\u63a8\u8350\u4fe1',
    'track': '\u8ffd\u8e2a',
    'traffic': '\u6d41\u91cf',
    'trend': '\u8d8b\u52bf',
    'visual': '\u89c6\u89c9\u7684',

    # Film
    'audition': '\u8bd5\u955c',
    'blockbuster': '\u5927\u7247',
    'caption': '\u5b57\u5e55',
    'cast': '\u6f14\u5458\u9635\u5bb9',
    'cinema': '\u7535\u5f71\u9662',
    'clip': '\u7247\u6bb5',
    'comedy': '\u559c\u5267',
    'costume': '\u670d\u88c5',
    'dialogue': '\u5bf9\u767d',
    'documentary': '\u7eaa\u5f55\u7247',
    'dub': '\u914d\u97f3',
    'ending': '\u7ed3\u5c40',
    'entertain': '\u5a31\u4e50',
    'epic': '\u53f2\u8bd7\u5927\u7247',
    'episode': '\u96c6',
    'extra': '\u7fa4\u4f17\u6f14\u5458',
    'fade': '\u6de1\u5165\u6de1\u51fa',
    'fantasy': '\u5947\u5e7b',
    'fiction': '\u865a\u6784',
    'footage': '\u7d20\u6750',
    'genre': '\u7c7b\u578b',
    'horror': '\u6050\u6016',
    'lens': '\u955c\u5934',
    'makeup': '\u5316\u5986',
    'motion': '\u52a8\u4f5c',
    'mystery': '\u60ac\u7591',
    'narrative': '\u53d9\u4e8b',
    'nominate': '\u63d0\u540d',
    'Oscar': '\u5965\u65af\u5361',
    'pilot': '\u8bd5\u64ad\u96c6',
    'plot': '\u5267\u60c5',
    'premiere': '\u9996\u6620',
    'preview': '\u9884\u544a',
    'producer': '\u5236\u7247\u4eba',
    'remake': '\u7ffb\u62cd',
    'romance': '\u7231\u60c5\u7247',
    'scene': '\u573a\u666f',
    'screenplay': '\u5267\u672c',
    'sequel': '\u7eed\u96c6',
    'series': '\u7cfb\u5217',
    'shot': '\u955c\u5934',
    'silent': '\u65e0\u58f0\u7684',
    'soundtrack': '\u539f\u58f0\u5e26',
    'subtitle': '\u5b57\u5e55',
    'thriller': '\u60ca\u609a\u7247',
    'trailer': '\u9884\u544a\u7247',
    'twist': '\u53cd\u8f6c',
    'villain': '\u53cd\u6d3e',

    # Medical
    'ache': '\u75bc\u75db',
    'acute': '\u6025\u6027\u7684',
    'addict': '\u4e0a\u763e\u8005',
    'adverse': '\u4e0d\u826f\u7684',
    'aging': '\u8001\u5316',
    'allergy': '\u8fc7\u654f',
    'ambulance': '\u6551\u62a4\u8f66',
    'anatomy': '\u89e3\u5256\u5b66',
    'antibiotic': '\u6297\u751f\u7d20',
    'artery': '\u52a8\u8109',
    'bandage': '\u7ef7\u5e26',
    'bruise': '\u7624\u4f24',
    'calcium': '\u9499',
    'cancer': '\u764c\u75c7',
    'capsule': '\u80f6\u56ca',
    'cardiac': '\u5fc3\u810f\u7684',
    'checkup': '\u4f53\u68c0',
    'chronic': '\u6162\u6027\u7684',
    'clinic': '\u8bca\u6240',
    'clinical': '\u4e34\u5e8a\u7684',
    'coma': '\u660f\u8ff7',
    'contagious': '\u4f20\u67d3\u6027\u7684',
    'deaf': '\u804b\u7684',
    'deficiency': '\u7f3a\u4e4f',
    'diagnose': '\u8bca\u65ad',
    'disability': '\u6b8b\u75be',
    'discharge': '\u51fa\u9662',
    'disease': '\u75be\u75c5',
    'dizzy': '\u5934\u6655',
    'dose': '\u5242\u91cf',
    'epidemic': '\u6d41\u884c\u75c5',
    'fatal': '\u81f4\u547d\u7684',
    'fatigue': '\u75b2\u52b3',
    'fever': '\u53d1\u70e7',
    'flu': '\u6d41\u611f',
    'fracture': '\u9aa8\u6298',
    'gene': '\u57fa\u56e0',
    'genetic': '\u9057\u4f20\u7684',
    'germ': '\u7ec6\u83cc',
    'hormone': '\u6fc0\u7d20',
    'hygiene': '\u536b\u751f',
    'immune': '\u514d\u75ab\u7684',
    'implant': '\u690d\u5165',
    'infant': '\u5a74\u513f',
    'infect': '\u611f\u67d3',
    'inflammation': '\u708e\u75c7',
    'inject': '\u6ce8\u5c04',
    'injection': '\u6ce8\u5c04',
    'intensive': '\u91cd\u75c7\u7684',
    'kidney': '\u80be\u810f',
    'laboratory': '\u5b9e\u9a8c\u5ba4',
    'limb': '\u80a2\u4f53',
    'liver': '\u809d\u810f',
    'lung': '\u80ba',
    'metabolism': '\u65b0\u9648\u4ee3\u8c22',
    'microscope': '\u663e\u5fae\u955c',
    'nerve': '\u795e\u7ecf',
    'nutrition': '\u8425\u517b',
    'obesity': '\u80a5\u80d6\u75c7',
    'organ': '\u5668\u5b98',
    'oxygen': '\u6c27\u6c14',
    'paralyse': '\u9ebb\u75f9',
    'pharmacy': '\u836f\u623f',
    'physician': '\u533b\u5e08',
    'pill': '\u836f\u7247',
    'poison': '\u6bd2\u836f',
    'pregnant': '\u6000\u5b55\u7684',
    'prescribe': '\u5f00\u5904\u65b9',
    'prescription': '\u5904\u65b9',
    'psychiatry': '\u7cbe\u795e\u75c5\u5b66',
    'pulse': '\u8109\u640f',
    'remedy': '\u6cbb\u7597\u65b9\u6cd5',
    'specialist': '\u4e13\u79d1\u533b\u751f',
    'spine': '\u810a\u67f1',
    'sterile': '\u65e0\u83cc\u7684',
    'stroke': '\u4e2d\u98ce',
    'surgeon': '\u5916\u79d1\u533b\u751f',
    'swallow': '\u541e\u54bd',
    'symptom': '\u75c7\u72b6',
    'syndrome': '\u7efc\u5408\u75c7',
    'therapy': '\u6cbb\u7597',
    'tissue': '\u7ec4\u7ec7',
    'toxic': '\u6709\u6bd2\u7684',
    'transplant': '\u79fb\u690d',
    'tumour': '\u80bf\u7624',
    'vaccine': '\u75ab\u82d7',
    'vein': '\u9759\u8109',
    'vitamin': '\u7ef4\u751f\u7d20',
    'ward': '\u75c5\u623f',
    'wound': '\u4f24\u53e3',
    'x-ray': 'X\u5c04\u7ebf',

    # Science
    'atom': '\u539f\u5b50',
    'beam': '\u5149\u675f',
    'biology': '\u751f\u7269\u5b66',
    'catalyst': '\u50ac\u5316\u5242',
    'chamber': '\u5b9e\u9a8c\u5ba4',
    'chemistry': '\u5316\u5b66',
    'clone': '\u514b\u9686',
    'coal': '\u7164\u70ad',
    'compound': '\u5316\u5408\u7269',
    'contaminate': '\u6c61\u67d3',
    'correlate': '\u76f8\u5173',
    'crystal': '\u6676\u4f53',
    'cycle': '\u5faa\u73af',
    'decay': '\u8870\u53d8',
    'density': '\u5bc6\u5ea6',
    'diagram': '\u56fe\u8868',
    'DNA': '\u8131\u6c27\u6838\u7cd6\u6838\u9178',
    'element': '\u5143\u7d20',
    'emit': '\u53d1\u5c04',
    'empirical': '\u7ecf\u9a8c\u7684',
    'enzyme': '\u9176',
    'equation': '\u7b49\u5f0f',
    'equilibrium': '\u5e73\u8861',
    'evolve': '\u8fdb\u5316',
    'experiment': '\u5b9e\u9a8c',
    'explode': '\u7206\u70b8',
    'fluid': '\u6d41\u4f53',
    'formula': '\u516c\u5f0f',
    'fossil': '\u5316\u77f3',
    'fraction': '\u5206\u6570',
    'friction': '\u6469\u64e6',
    'fuel': '\u71c3\u6599',
    'fundamental': '\u57fa\u672c\u7684',
    'fusion': '\u878d\u5408',
    'gas': '\u6c14\u4f53',
    'geology': '\u5730\u8d28\u5b66',
    'gravity': '\u91cd\u529b',
    'habitat': '\u6816\u606f\u5730',
    'humidity': '\u6e7f\u5ea6',
    'hydrogen': '\u6c22',
    'hypothesis': '\u5047\u8bbe',
    'infrared': '\u7ea2\u5916\u7ebf',
    'ingredient': '\u6210\u5206',
    'inspect': '\u68c0\u67e5',
    'instrument': '\u4eea\u5668',
    'insulate': '\u7edd\u7f18',
    'interval': '\u95f4\u9694',
    'journal': '\u671f\u520a',
    'laser': '\u6fc0\u5149',
    'layer': '\u5c42',
    'liquid': '\u6db2\u4f53',
    'magnet': '\u78c1\u94c1',
    'magnitude': '\u91cf\u7ea7',
    'mass': '\u8d28\u91cf',
    'mechanism': '\u673a\u5236',
    'mineral': '\u77ff\u7269',
    'mixture': '\u6df7\u5408\u7269',
    'molecule': '\u5206\u5b50',
    'momentum': '\u52a8\u91cf',
    'neutral': '\u4e2d\u6027\u7684',
    'neutron': '\u4e2d\u5b50',
    'nitrogen': '\u6c2e',
    'nuclear': '\u6838\u7684',
    'nucleus': '\u539f\u5b50\u6838',
    'orbit': '\u8f68\u9053',
    'organism': '\u6709\u673a\u4f53',
    'oxide': '\u6c27\u5316\u7269',
    'particle': '\u7c92\u5b50',
    'phase': '\u9636\u6bb5',
    'phenomenon': '\u73b0\u8c61',
    'physics': '\u7269\u7406\u5b66',
    'plasma': '\u7b49\u79bb\u5b50\u4f53',
    'polar': '\u6781\u6027\u7684',
    'principle': '\u539f\u7406',
    'probe': '\u63a2\u9488',
    'protein': '\u86cb\u767d\u8d28',
    'proton': '\u8d28\u5b50',
    'quantum': '\u91cf\u5b50',
    'radiation': '\u8f90\u5c04',
    'reaction': '\u53cd\u5e94',
    'reagent': '\u8bd5\u5242',
    'satellite': '\u536b\u661f',
    'sequence': '\u5e8f\u5217',
    'solar': '\u592a\u9633\u7684',
    'solution': '\u6eb6\u6db2',
    'species': '\u7269\u79cd',
    'specimen': '\u6807\u672c',
    'spectrum': '\u5149\u8c31',
    'stable': '\u7a33\u5b9a\u7684',
    'static': '\u9759\u6001\u7684',
    'stem': '\u5e72\u7ec6\u80de',
    'substance': '\u7269\u8d28',
    'synthesis': '\u5408\u6210',
    'temperature': '\u6e29\u5ea6',
    'theorem': '\u5b9a\u7406',
    'thermal': '\u70ed\u7684',
    'trial': '\u5b9e\u9a8c',
    'universe': '\u5b87\u5b99',
    'vacuum': '\u771f\u7a7a',
    'valid': '\u6709\u6548\u7684',
    'variable': '\u53d8\u91cf',
    'velocity': '\u901f\u5ea6',
    'volume': '\u4f53\u79ef',
    'wave': '\u6ce2',
    'wavelength': '\u6ce2\u957f',
    # Additional missing
    'module': '\u6a21\u5757',
    'navigate': '\u5bfc\u822a',
    'beta': '\u6d4b\u8bd5\u7248',
    'dragon': '\u9f99',
    'shield': '\u76fe\u724c',
    'decline': '\u4e0b\u964d',
    'animate': '\u5236\u4f5c\u52a8\u753b',
    'applause': '\u638c\u58f0',
    'performer': '\u8868\u6f14\u8005',
    'depress': '\u4f7f\u6c2e\u4e27',
    'exhaust': '\u8017\u5c3d',
    'approximate': '\u8fd1\u4f3c\u7684',
}


def load_oxford_translations(csv_path):
    """Load translations from Oxford 5000 CSV file."""
    translations = {}
    with open(csv_path, 'r', encoding='utf-8') as f:
        reader = csv.DictReader(f)
        for row in reader:
            term = row['term'].strip().lower()
            translation = row['translation'].strip()
            if translation:
                translations[term] = translation
    return translations


def generate_wordbook_js(topic_id, topic_info, words_data):
    """Generate JS file content for a topic wordbook."""
    lines = []
    lines.append(f"registerWordbook('topic_{topic_id}', {{")
    lines.append(f'    name: "{topic_info["name"]}",')
    lines.append(f'    emoji: "{topic_info["emoji"]}",')
    lines.append(f"    group: 'topic',")
    lines.append(f'    description: "{topic_info["description"]}",')
    lines.append(f'    levels: {{')
    lines.append(f'        all: {{')
    lines.append(f'            name: "{topic_info["emoji"]} \u5168\u90e8",')
    lines.append(f'            words: [')

    for i, entry in enumerate(words_data):
        word = entry['word']
        meaning = entry['meaning'].replace('"', '\\"').replace("'", "\\'")
        audio = f'"{entry["audio"]}"' if entry['audio'] else 'null'
        comma = ',' if i < len(words_data) - 1 else ''
        lines.append(f'                {{ word: "{word}", meaning: "{meaning}", audio: {audio} }}{comma}')

    lines.append(f'            ]')
    lines.append(f'        }}')
    lines.append(f'    }}')
    lines.append(f'}});')
    lines.append('')

    return '\n'.join(lines)


def main():
    print("=" * 60)
    print("Topic Wordbook Generator")
    print("=" * 60)

    # Load Oxford translations
    print(f"\nLoading Oxford 5000 translations from: {OXFORD_CSV}")
    oxford_translations = load_oxford_translations(OXFORD_CSV)
    print(f"  Loaded {len(oxford_translations)} Oxford translations")

    os.makedirs(OUTPUT_DIR, exist_ok=True)

    total_words = 0
    total_audio = 0

    for topic_id, topic_info in TOPIC_CATEGORIES.items():
        print(f"\n--- {topic_info['emoji']} {topic_info['name']} ({topic_id}) ---")

        words_data = []
        missing_translations = []

        # Deduplicate word list
        seen = set()
        unique_words = []
        for w in topic_info['words']:
            w_lower = w.lower()
            if w_lower not in seen:
                seen.add(w_lower)
                unique_words.append(w)

        for word in unique_words:
            word_lower = word.lower()

            # Get translation
            meaning = oxford_translations.get(word_lower)
            if meaning is None:
                meaning = EXTRA_TRANSLATIONS.get(word_lower)
            if meaning is None:
                meaning = EXTRA_TRANSLATIONS.get(word)
            if meaning is None:
                missing_translations.append(word)
                meaning = word  # fallback

            # Check audio
            audio_file = f"{word_lower}.wav"
            audio_path = os.path.join(AUDIO_DIR, audio_file)
            audio = audio_file if os.path.exists(audio_path) else None

            words_data.append({
                'word': word_lower,
                'meaning': meaning,
                'audio': audio,
            })

        # Count stats
        audio_count = sum(1 for w in words_data if w['audio'])
        total_words += len(words_data)
        total_audio += audio_count

        print(f"  Words: {len(words_data)}")
        print(f"  Audio: {audio_count}/{len(words_data)} ({100*audio_count/len(words_data):.1f}%)")
        if missing_translations:
            print(f"  Missing translations: {missing_translations}")

        # Generate JS
        js_content = generate_wordbook_js(topic_id, topic_info, words_data)
        output_path = os.path.join(OUTPUT_DIR, f'topic_{topic_id}.js')
        with open(output_path, 'w', encoding='utf-8') as f:
            f.write(js_content)
        print(f"  Written: {output_path}")

    print(f"\n{'=' * 60}")
    print(f"SUMMARY")
    print(f"{'=' * 60}")
    print(f"Topics generated: {len(TOPIC_CATEGORIES)}")
    print(f"Total words: {total_words}")
    print(f"Total audio: {total_audio}/{total_words} ({100*total_audio/total_words:.1f}%)")
    print(f"\nDone!")


if __name__ == '__main__':
    main()
